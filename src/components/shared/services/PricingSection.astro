---
export interface PricingFeature { included: boolean; text: string; }
export interface PricingPlan {
  name: string;
  description: string;
  priceRange: string;
  unit: string;
  features: PricingFeature[];
  highlighted?: boolean;
}
export interface InfoBullet { iconClass: string; text: string }
export interface ExtraInfoBox {
  title: string;
  bullets: InfoBullet[];
  cta?: { href: string; label: string; iconClass?: string };
}
export interface PricingSectionProps {
  eyebrow?: string;
  title: string;
  subtitle?: string;
  plans: PricingPlan[];
  extraInfo?: ExtraInfoBox;
}

const { eyebrow = 'Preise', title, subtitle, plans, extraInfo } = Astro.props as PricingSectionProps;
---

<section class="py-20 sm:py-24 bg-white" data-animate>
  <div class="container mx-auto max-w-7xl px-4 sm:px-6">
    <div class="text-center max-w-3xl mx-auto mb-16">
      <p class="text-xs tracking-[0.18em] text-[var(--color-professional)] font-medium uppercase mb-3">{eyebrow}</p>
      <h2 class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-gray-900 leading-tight mb-5">{title}</h2>
      {subtitle && (<p class="text-lg text-gray-600">{subtitle}</p>)}
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      {plans.map((plan, index) => (
        <div class={`relative rounded-2xl p-8 transition-all duration-300 hover:transform hover:scale-105 ${plan.highlighted ? 'bg-gradient-to-br from-gray-900 to-gray-800 text-white shadow-2xl' : 'bg-white border-2 border-gray-200 hover:border-gray-300'}`} style={`animation-delay: ${index * 100}ms`}>
          {plan.highlighted && (
            <div class="absolute -top-4 left-1/2 transform -translate-x-1/2">
              <span class="inline-block px-4 py-1 bg-[var(--color-paint-accent)] text-gray-900 rounded-full text-sm font-bold">BELIEBT</span>
            </div>
          )}
          <div class="mb-6">
            <h3 class={`text-2xl font-bold mb-2 ${plan.highlighted ? 'text-white' : 'text-gray-900'}`}>{plan.name}</h3>
            <p class={`text-sm ${plan.highlighted ? 'text-white/80' : 'text-gray-600'}`}>{plan.description}</p>
          </div>
          <div class="mb-6">
            <div class="flex items-baseline gap-2">
              <span class={`text-3xl md:text-4xl font-bold ${plan.highlighted ? 'text-white' : 'text-gray-900'}`}>{plan.priceRange}</span>
              {plan.unit && (<span class={`text-sm ${plan.highlighted ? 'text-white/80' : 'text-gray-600'}`}>{plan.unit}</span>)}
            </div>
          </div>
          <ul class="space-y-3">
            {plan.features.map((feature) => (
              <li class="flex items-start gap-3">
                <span class={`mt-1 inline-flex items-center justify-center w-5 h-5 rounded-full ${feature.included ? 'bg-green-100 text-green-700' : 'bg-gray-200 text-gray-500'}`}>
                  <i class={`fa-solid ${feature.included ? 'fa-check' : 'fa-minus'} text-[10px]`}></i>
                </span>
                <span class={`${plan.highlighted ? 'text-white/90' : 'text-gray-700'}`}>{feature.text}</span>
              </li>
            ))}
          </ul>
          <div class="mt-8">
            <a href="#kontakt" class={`w-full inline-flex items-center justify-center px-6 py-3 rounded-full font-semibold transition-colors focus-ring ${plan.highlighted ? 'bg-white text-gray-900 hover:bg-gray-100' : 'bg-gray-900 text-white hover:bg-black'}`}>Offerte anfordern</a>
          </div>
        </div>
      ))}
    </div>

    {extraInfo && (
      <div class="mt-16 bg-[var(--color-accent)] rounded-2xl p-8 md:p-10">
        <div class="grid md:grid-cols-2 gap-8 items-center">
          <div>
            <h3 class="text-2xl font-bold text-gray-900 mb-4">{extraInfo.title}</h3>
            <ul class="space-y-3 text-gray-700" role="list">
              {extraInfo.bullets.map(b => (
                <li class="flex items-start gap-3">
                  <i class={b.iconClass + ' mt-1'} aria-hidden="true"></i>
                  <span>{b.text}</span>
                </li>
              ))}
            </ul>
          </div>
          <div class="text-center md:text-right">
            {extraInfo.cta && (
              <a href={extraInfo.cta.href} class="inline-flex items-center justify-center px-6 py-3 rounded-full bg-gray-900 text-white font-medium hover:bg-black transition-colors focus-ring" aria-label={extraInfo.cta.label}>
                {extraInfo.cta.iconClass && (<i class={extraInfo.cta.iconClass + ' mr-2'} aria-hidden="true"></i>)}
                {extraInfo.cta.label}
              </a>
            )}
          </div>
        </div>
      </div>
    )}
  </div>
</section>
